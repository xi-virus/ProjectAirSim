

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project AirSim ROS Bridge &mdash; Project Airsim 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Project Airsim
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Sensors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_capture_settings.html">Supported imaging/capture camera customizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_capture_settings.html#sample-config">Sample config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_post_processing_with_nn.html">Camera Images Post processing using Neural Network models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_post_processing_with_nn.html#image-post-processing-settings">Image post processing settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_post_processing_with_nn.html#post-processing-model-settings">Post processing model settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_streaming.html">Camera Streaming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/segmentation.html">Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/lidar.html">Lidar sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/lidar.html#lidar-sensor-settings">Lidar sensor settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/radar.html">Radar sensor overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/radar.html#radar-sensor-settings">Radar sensor settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/battery.html">Battery sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/battery.html#battery-sensor-settings">Battery sensor settings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics and Simulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../physics/fast_physics.html">Fast Physics for Drones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics/matlab_physics.html">Matlab Physics for Drones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scene/sim_clock.html">Simulation Clock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scene/weather_visual_effects.html">Weather Visual Effects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Controllers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../controllers/controllers.html">Flight Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/simple_flight.html">Simple Flight Controller for Drones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4.html">PX4 Autopilot Flight Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_build.html">Building PX4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_hitl.html">Using a PX4 Controller as Hardware-In-The-Loop (HITL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_lockstep.html">PX4 Lockstep Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_multi_vehicle.html">PX4 with Multiple Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_sitl.html">Using a PX4 Controller as Software-In-The-Loop (SITL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_sitl_wsl2.html">PX4 Software-in-the-Loop with WSL 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Settings</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://iamaisim.github.io/ProjectAirSim/api_docs/index.html">Python Client API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Project Airsim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Project AirSim ROS Bridge</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ros/ros.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="project-airsim-ros-bridge">
<h1>Project AirSim ROS Bridge<a class="headerlink" href="#project-airsim-ros-bridge" title="Link to this heading">¶</a></h1>
<p>Project AirSim can join a ROS1 (Robot Operating System) network using the Project AirSim ROS Bridge.  The bridge is a pure Python ROS1 node that connects to Project AirSim using the Client API.  The bridge is provided as a ROS package and the stand-alone node Python script can be launched using ROS mechanisms such as <code class="docutils literal notranslate"><span class="pre">rosrun</span></code> or <code class="docutils literal notranslate"><span class="pre">roslaunch</span></code> but the script can also be run directly with the Python interpreter.  The core bridge Python modules are provided as a Python package to allow the bridge to be integrated with other client code.</p>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<p>The Project AirSim ROS Bridge requires the following:</p>
<ul class="simple">
<li><p>A version of Python supported by the <a class="reference internal" href="../client_setup.html#python-client"><span class="std std-ref">Project AirSim Client API</span></a>.</p></li>
<li><p>The following Python packages in addition to those required by the Client API: <a class="reference external" href="http://wiki.ros.org/rospy">rospy</a>, <a class="reference external" href="http://wiki.ros.org/geometry_msgs">geometry_msgs</a>, <a class="reference external" href="http://wiki.ros.org/radar_msgs">radar_msgs</a>, <a class="reference external" href="http://wiki.ros.org/sensor_msgs">sensor_msgs</a>, <a class="reference external" href="http://wiki.ros.org/std_msgs">std_msgs</a>, and <a class="reference external" href="http://wiki.ros.org/tf">tf</a>.</p></li>
</ul>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Setup <a class="reference internal" href="../client_setup.html#python-client"><span class="std std-ref">Project AirSim Client API</span></a>.</p></li>
<li><p>In the same the <code class="docutils literal notranslate"><span class="pre">client</span></code> folder from the Project AirSim distribution, locate the <code class="docutils literal notranslate"><span class="pre">ProjectAirSim_ROS.zip</span></code> compressed archive file and extract the files so that the top-level <code class="docutils literal notranslate"><span class="pre">ros</span></code> directory is a sibling to the
<code class="docutils literal notranslate"><span class="pre">client</span></code> directory of the extracted Project AirSim Client API files.</p></li>
<li><p>The Project AirSim ROS Bridge is provided as a ROS catkin package, <code class="docutils literal notranslate"><span class="pre">projectairsim_ros</span></code>.  Adding this package to your catkin workspace and building it will ensure dependencies are addressed.  It’s recommended to add a soft link in the <code class="docutils literal notranslate"><span class="pre">catkin_ws/src</span></code> directory to the <code class="docutils literal notranslate"><span class="pre">ros</span></code> directory of the extracted Project AirSim distribution files which will add all Project AirSim ROS packages to your ROS catkin workspace.</p></li>
<li><p>Activate the <a class="reference internal" href="../client_setup.html"><span class="std std-doc">Python virtual environment setup for Project AirSim</span></a>.</p></li>
<li><p>Install the Project AirSim ROS Python library from the <code class="docutils literal notranslate"><span class="pre">projectairsim_ros-{version}-py3-none-any.whl</span></code> file in the distribution:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> python -m pip install path\to\projectairsim_ros-{version}-py3-none-any.whl
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">version</span></code> is the actual version ID.</p>
</li>
</ol>
</section>
<section id="ros-bridge-library-in-place-install">
<h2>ROS bridge library in-place install<a class="headerlink" href="#ros-bridge-library-in-place-install" title="Link to this heading">¶</a></h2>
<p>For convenience, internal developers may wish to install the Project AirSim ROS Bridge Python package (<code class="docutils literal notranslate"><span class="pre">projectairsim_ros</span></code>) “in place” instead of from the Python wheel file.  This allows changes to the package sources to be automatically picked up without having to rebuild and reinstall the wheel each time.  Developers are free to install the wheel, however, if they wish.</p>
<p>Follow the instructions <a class="reference internal" href="#setup"><span class="std std-ref">setup for the Project AirSim ROS Bridge</span></a>, but instead of installing the *.whl file, do the following:</p>
<ul class="simple">
<li><p>If the <code class="docutils literal notranslate"><span class="pre">projectairsim_ros</span></code> package was previously installed from the wheel, uninstall the package first with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>pip<span class="w"> </span>uninstall<span class="w"> </span>projectairsim_ros
</pre></div>
</div>
<ul class="simple">
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">ros/node</span></code> directory and install the package using the <code class="docutils literal notranslate"><span class="pre">-e</span></code> command-line switch:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">    </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>projectairsim_ros
</pre></div>
</div>
</section>
<section id="building">
<h2>Building<a class="headerlink" href="#building" title="Link to this heading">¶</a></h2>
<p>Building the Project AirSim ROS Bridge package is not necessary to use the bridge, although doing so may help ensure dependencies are satisfied. To build the Project AirSim ROS Bridge package, include the Project AirSim ROS Bridge directory <code class="docutils literal notranslate"><span class="pre">ros</span></code> in the ROS catkin workspace and run <code class="docutils literal notranslate"><span class="pre">catkin_make</span></code>.</p>
</section>
<section id="running">
<h2>Running<a class="headerlink" href="#running" title="Link to this heading">¶</a></h2>
<p>The Project AirSim ROS Bridge must be run from within a <a class="reference internal" href="../client_setup.html"><span class="std std-doc">Python virtual environment setup for Project AirSim</span></a>.  Once all dependencies are present, launch the Project AirSim ROS Bridge with one of the following ways:</p>
<ul class="simple">
<li><p>Run the main node file with Python:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>projectairsim/ros/node/scripts/projectairsim_node.py
</pre></div>
</div>
<ul class="simple">
<li><p>Launch by <code class="docutils literal notranslate"><span class="pre">rosrun</span></code>.  Ensure that the Project AirSim <code class="docutils literal notranslate"><span class="pre">ros/node</span></code> directory is in or under a directory in the <code class="docutils literal notranslate"><span class="pre">ROS_PACKAGE_PATH</span></code> environment variable and that the <code class="docutils literal notranslate"><span class="pre">projectairsim_node.py</span></code> is marked executable.  The bridge can then be launched with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rosrun<span class="w"> </span>projectairsim_ros<span class="w"> </span>projectairsim_node.py
</pre></div>
</div>
<ul class="simple">
<li><p>Launch by <code class="docutils literal notranslate"><span class="pre">roslaunch</span></code> from a <code class="docutils literal notranslate"><span class="pre">.launch</span></code> file .  Ensure that the Project AirSim <code class="docutils literal notranslate"><span class="pre">ros/node</span></code> directory is in or under a directory in the <code class="docutils literal notranslate"><span class="pre">ROS_PACKAGE_PATH</span></code> environment variable and that the <code class="docutils literal notranslate"><span class="pre">projectairsim_node.py</span></code> is marked executable.  The bridge can then be launched from a <code class="docutils literal notranslate"><span class="pre">.launch</span></code> file with an entry similar this:</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="nt">&lt;node</span><span class="w"> </span><span class="na">pkg=</span><span class="s">&quot;projectairsim_ros&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;projectairsim_node&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;projectairsim_node.py&quot;</span><span class="w"> </span><span class="na">output=</span><span class="s">&quot;screen&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p><strong>Note:</strong> The Project AirSim ROS Bridge uses the Project AirSim Client API, and currently the Project AirSim ROS Bridge and other client scripts (like flight mission scripts) cannot connect to Project AirSim simultaneously as separate scripts.  For a work-around, see <a class="reference internal" href="#running-with-a-mission-script"><span class="xref myst">Running with a mission script</span></a>, below.</p>
</section>
<section id="command-line-arguments">
<h2>Command-line arguments<a class="headerlink" href="#command-line-arguments" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Switch</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code>‑‑address</code></p></td>
<td><p>string</p></td>
<td><p>127.0.0.1</p></td>
<td><p>The IP address of the host running Project AirSim (e.g., <code>‑‑address=127.0.0.1</code>).</p></td>
</tr>
<tr class="row-odd"><td><p><code>‑‑nodename</code></p></td>
<td><p>string</p></td>
<td><p>“projectairsim” + random</p></td>
<td><p>The name of the Project AirSim ROS Bridge node.  By default, the node uses the name “<code class="docutils literal notranslate"><span class="pre">projectairsim</span></code>” with <code class="docutils literal notranslate"><span class="pre">rospy_init_node()</span></code>’s <code class="docutils literal notranslate"><span class="pre">anonymous</span></code> argument set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.  If this switch is specified, the <code class="docutils literal notranslate"><span class="pre">anonymous</span></code> argument is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code>‑‑simconfigpath</code></p></td>
<td><p>string</p></td>
<td><p>“sim_config/”</p></td>
<td><p>The path to the directory containing the Project AirSim config files.  The path is relative to Project AirSim ROS Bridge node’s current working directory.</p></td>
</tr>
<tr class="row-odd"><td><p><code>‑‑servicesport</code></p></td>
<td><p>integer</p></td>
<td><p>8990</p></td>
<td><p>The Project AirSim services TCP/IP port.  This can be changed by the <a class="reference internal" href="../command_line_switches.html#command_line_switches"><span class="std std-ref">-servicesport</span></a> command-line switch to Project AirSim.</p></td>
</tr>
<tr class="row-even"><td><p><code>‑‑topicsport</code></p></td>
<td><p>integer</p></td>
<td><p>8989</p></td>
<td><p>The Project AirSim pub-sub TCP/IP port.  This can be changed by the <a class="reference internal" href="../command_line_switches.html#command_line_switches"><span class="std std-ref">-topicsport</span></a> command-line switch to Project AirSim.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ros-topics-and-tf-transform-api">
<h2>ROS topics and tf transform API<a class="headerlink" href="#ros-topics-and-tf-transform-api" title="Link to this heading">¶</a></h2>
<p>The following ROS topics and transform frames are subscribed to and advertised by the Project AirSim ROS Bridge.  Parts of the topic and frame ID names change depending on the simulation configuration:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Replaced By</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code><em>&lt;scene_name&gt;</em></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> value in the scene configuration file.</p></td>
</tr>
<tr class="row-odd"><td><p><code><em>&lt;robot_name&gt;</em></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> value of an entry in the <code class="docutils literal notranslate"><span class="pre">actor</span></code> section of the <a class="reference internal" href="../config_scene.html#actor-settings"><span class="std std-ref">scene configuration file</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code><em>&lt;camera_name&gt;</em></code><br><code><em>&lt;lidar_name&gt;</em></code><br><code><em>&lt;radar_name&gt;</em></code></p></td>
<td><p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> value of an entry in the <code class="docutils literal notranslate"><span class="pre">sensor</span></code> section of the <a class="reference internal" href="../config_robot.html#sensor-settings"><span class="std std-ref">robot configuration file</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code><em>&lt;image_type&gt;</em></code></p></td>
<td><p>The type of image set by the <code class="docutils literal notranslate"><span class="pre">image-type</span></code> value of an entry in the <code class="docutils literal notranslate"><span class="pre">capture-settings</span></code> array for the camera under the <code class="docutils literal notranslate"><span class="pre">sensor</span></code> section of the <a class="reference internal" href="../config_robot.html#sensor-settings"><span class="std std-ref">robot configuration file</span></a>. See <a class="reference internal" href="#image-type"><span class="xref myst">Image type</span></a>, below.</p></td>
</tr>
</tbody>
</table>
<section id="image-type">
<h3>Image type<a class="headerlink" href="#image-type" title="Link to this heading">¶</a></h3>
<p>The mapping between the <code class="docutils literal notranslate"><span class="pre">image-type</span></code> value and the <em><code class="docutils literal notranslate"><span class="pre">&lt;image_type&gt;</span></code></em> value is:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><code class="docutils literal notranslate"><span class="pre">image_type</span></code></p></th>
<th class="head"><p><em><code>&lt;image_type&gt;</code></em></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scene_camera</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">depth_planar_camera</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">depth_camera</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">segmentation_camera</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">depth_vis_camera</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>5</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">disparity_normalized_camera</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>6</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">surface_normals</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="subscribed-topics">
<h3>Subscribed topics<a class="headerlink" href="#subscribed-topics" title="Link to this heading">¶</a></h3>
<p><code>/ProjectAirSim/node/<em>&lt;node_name&gt;</em>/load_scene</code>
(<a class="reference external" href="http://docs.ros.org/en/api/std_msgs/html/msg/String.html">std_msgs/String</a>)</p>
<ul><li style="list-style-type: none;">Project AirSim will load a new simulation scene when this topic is set to the name of a scene configuration file.  The scene configuration file must be in the directory specified by the <code>&#x2011;&#x2011;simconfigpath</code> command-line switch.  <b>Warning:</b> All topics containing the scene name are unregistered and new topics are advertised and subscribed to as appropriate for the the new scene.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/cmd_vel</code>
(<a class="reference external" href="http://docs.ros.org/en/api/geometry_msgs/html/msg/Twist.html">geometry_msgs/Twist</a>)</p>
<ul><li style="list-style-type: none;">Request to move the robot at the specified linear and angular velocities.  As a safety feature, a message must be published at least every three seconds or the robot will stop movement.  Note the robot may ignore velocity parameters it does not support or cannot support at the moment.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/desired_pose</code>
(<a class="reference external" href="http://docs.ros.org/en/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a>)</p>
<ul><li style="list-style-type: none;">Request to move the robot to the specified pose.  The robot is immediately placed in the specified pose.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/camera_name&gt;*/desired_pose</code>
(<a class="reference external" href="http://docs.ros.org/en/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a>)</p>
<ul><li style="list-style-type: none;">Request to move the camera sensor to the specified pose.  The camera is immediately placed in the specified pose.  Note that this topic is on the camera root path and not on child image type paths.  Setting the camera pose affects all image types produced by the camera sensor.  Only available when an actor is configured with a camera sensor.</li></ul>
</section>
<section id="published-topics">
<h3>Published topics<a class="headerlink" href="#published-topics" title="Link to this heading">¶</a></h3>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/actual_pose</code>
(<a class="reference external" href="http://docs.ros.org/en/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a>)</p>
<ul><li style="list-style-type: none;">Robot's current pose.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/camera_name&gt;<em>/</em>&lt;camera_pose</code>
(<a class="reference external" href="http://docs.ros.org/en/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a>)</p>
<ul><li style="list-style-type: none;">Camera's current pose.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/camera_name&gt;<em>/</em>&lt;image_type&gt;*/image</code>
(<a class="reference external" href="http://docs.ros.org/en/api/sensor_msgs/html/msg/Image.html">sensor_msgs/Image</a>)</p>
<ul><li style="list-style-type: none;">Images as captured by the camera sensor.  The available image types are: <code>scene_camera</code>, <code>depth_camera</code>, and <code>depth_planar_camera</code>.  This topic is paired with a matching <code>camera_info</code> topic.  Only available when an actor is configured with a camera sensor.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/camera_name&gt;<em>/</em>&lt;image_type&gt;*/camera_info</code>
(<a class="reference external" href="http://docs.ros.org/en/api/sensor_msgs/html/msg/CameraInfo.html">sensor_msgs/CameraInfo</a>)</p>
<ul><li style="list-style-type: none;">Information about the camera image.  The available image types are: <code>scene_camera</code>, <code>depth_camera</code>, and <code>depth_planar_camera</code>.  This topic is paired with a matching <code>image</code> topic.  Only available when an actor is configured with a camera sensor.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/lidar_name&gt;*/lidar</code>
(<a class="reference external" href="http://docs.ros.org/en/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a>)</p>
<ul><li style="list-style-type: none;">A point cloud of the returns seen by the LIDAR sensor.  Only available when an actor is configured with a LIDAR sensor.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/radar_name&gt;*/radar_detections</code>
(<a class="reference external" href="http://docs.ros.org/en/noetic/api/radar_msgs/html/msg/RadarScan.html">radar_msgs/RadarScan</a>)</p>
<ul><li style="list-style-type: none;">Relative directions and velocities of RADAR signal returns.  Only available when an actor is configured with a RADAR sensor.</li></ul>
<p><code>/airsim_node/<em>&lt;robot_name&gt;</em>/radar_name&gt;*/radar_tracks</code>
(<a class="reference external" href="http://docs.ros.org/en/noetic/api/radar_msgs/html/msg/RadarTracks.html">radar_msgs/RadarTracks</a>)</p>
<ul><li style="list-style-type: none;">Estimated 3D trajectories of objects detected by the RADAR sensor.  Only available when an actor is configured with a RADAR sensor.</li></ul>
<p><code>/airsim_streaming_camera/image_raw</code></p>
<ul><li style="list-style-type: none;"> Currently, only one camera can stream video at a time, but support for multiple simultaneous camera streams is under development. To enable camera streaming, use the following <code>capture-settings</code> configuration: <code>"streaming-enabled": true</code>. If multiple cameras have streaming enabled, you can switch between them using the <code>switch_streaming_view</code>API.  
If you experience low resolution or incorrect image output, it may be due to frame loss in the H.264 stream. Try reducing the [Pixel Streaming transmission frequency](docs/sensors/camera_streaming.md#setting-the-maximum-fps-for-pixel-streaming) to mitigate the issue.</li></ul>
</section>
<section id="broadcasted-transform-frames">
<h3>Broadcasted transform frames<a class="headerlink" href="#broadcasted-transform-frames" title="Link to this heading">¶</a></h3>
<p><code>airsim_node/<em>&lt;robot_name&gt;</em></code></p>
<ul><li style="list-style-type: none;">Robot's base transform frame from the <code>map</code> parent frame ID.</li></ul>
<p><code>airsim_node/<em>&lt;robot_name&gt;</em>/camera_name&gt;<em>/</em>&lt;image_type&gt;*</code></p>
<ul><li style="list-style-type: none;">The camera image's transform frame from the <code>map</code> parent frame ID.</li></ul>
</section>
<section id="coordinate-conversion">
<h3>Coordinate conversion<a class="headerlink" href="#coordinate-conversion" title="Link to this heading">¶</a></h3>
<p>The bridge handles the conversion between data representations used by ROS and Project AirSim, both based on the NED (North-East-Down: right-handed coordinates, X-forward, Y-right, Z-down) coordinate system.</p>
<p>For instance, the <code class="docutils literal notranslate"><span class="pre">actual_pose</span></code> ROS topic reports the vehicle’s position and orientation in NED coordinates, and the Project AirSim Client API also provides the vehicle’s position in NED coordinates. Similarly, when setting the pose of the vehicle through the <code class="docutils literal notranslate"><span class="pre">desired_pose</span></code> ROS topic, you specify the pose in NED coordinates, and the bridge ensures that this data is correctly passed to Project AirSim.</p>
</section>
</section>
<section id="running-with-a-mission-script">
<h2>Running with a mission script<a class="headerlink" href="#running-with-a-mission-script" title="Link to this heading">¶</a></h2>
<p>The Project AirSim ROS Bridge uses the Project AirSim Client API.  Currently, Project AirSim only supports one client at a time thus precluding other clients such as flight mission scripts from connecting to an Project AirSim instance already connected to an Project AirSim ROS Bridge.</p>
<p>The work-around is to combine the Project AirSim ROS Bridge with the mission script so that they can share a single <code class="docutils literal notranslate"><span class="pre">ProjectAirSimClient</span></code> instance and use the Python <code class="docutils literal notranslate"><span class="pre">asyncio</span></code> facility to run both the bridge and the mission script at the same time.  The <code class="docutils literal notranslate"><span class="pre">projectairsimnode.py</span></code> script does little more than create an instance of the <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> class and enter the ROS main loop.  The <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> class implements all of the functionality of the Project AirSim ROS Bridge.</p>
<p>The example script <code class="docutils literal notranslate"><span class="pre">hello_ros.py</span></code> in the <code class="docutils literal notranslate"><span class="pre">ros/node/scripts</span></code> directory shows one way to launch the ROS node with a mission script.  To run this example:</p>
<ol class="arabic simple">
<li><p>Launch Project AirSim.</p></li>
<li><p>Open a command prompt or terminal.</p></li>
<li><p>Activate the Python virtual environment created for Project AirSim clients as discussed in the <a class="reference internal" href="../client_setup.html"><span class="std std-doc">Project AirSim client setup</span></a> page.</p></li>
<li><p>Ensure <code class="docutils literal notranslate"><span class="pre">roscore</span></code> is running and, if necessary, that the <code class="docutils literal notranslate"><span class="pre">ROS_MASTER_URI</span></code> environment variable is set correctly.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command to go to the <code class="docutils literal notranslate"><span class="pre">ros/node/scripts</span></code> directory.</p></li>
<li><p>Run the script with the following command:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>hello_ros.py
</pre></div>
</div>
<p>The script will load a simulation scene and fly the drone from the launch pad to the orange ball, back to the launch pad, and repeat as long as the script is running.  Meanwhile the Project AirSim ROS Bridge node will have connected to the ROS network and the <code class="docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">list</span></code> command will show all of the topics it has made available.</p>
<p>Here’s a step-by-step breakdown of how <code class="docutils literal notranslate"><span class="pre">hello_ros.py</span></code> works:</p>
<ul class="simple">
<li><p>After parsing the command line, a ROS node is created using <code class="docutils literal notranslate"><span class="pre">rospy.init_node()</span></code>.</p></li>
<li><p>The logger used by the Project AirSim client library is redirected through the ROS logger.  Ordinarily, ROS redirects all non-ROS logger output to a file.  See <strong>Note 1</strong>.</p></li>
<li><p>An <code class="docutils literal notranslate"><span class="pre">ProjectAirSimClient</span></code> object is created and connected to the running instance of Project AirSim.</p></li>
<li><p>Project AirSim is directed to load the scene config file <code class="docutils literal notranslate"><span class="pre">scene_drone_sensors.jsonc</span></code>.  The bridge looks for simulation config files in the directory specified by the <code class="docutils literal notranslate"><span class="pre">--simconfigpath</span></code> command-line switch which defaults to <code class="docutils literal notranslate"><span class="pre">../../../client/python/example_user_scripts/sim_config</span></code>.  Project AirSim will load the scene which uses the <code class="docutils literal notranslate"><span class="pre">Blocks</span></code> environment with one drone.</p></li>
<li><p>Next the <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> object is created—this object runs the Project AirSim ROS Bridge node. The <code class="docutils literal notranslate"><span class="pre">ProjectAirSimClient</span></code> object we created earlier is passed-in so the constructor won’t create its own.  For convenience, you can instead allow it to create the <code class="docutils literal notranslate"><span class="pre">ProjectAirSimClient</span></code> object and then retrieve it–see <strong>Note 2</strong>.</p></li>
<li><p>Now that the simulation environment and the ROS node are setup and running, the script launches the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function to run asynchronously and enters the <code class="docutils literal notranslate"><span class="pre">rospy</span></code> main loop with <code class="docutils literal notranslate"><span class="pre">rospy.spin()</span></code>.  The <code class="docutils literal notranslate"><span class="pre">main()</span></code> function runs the mission script and the <code class="docutils literal notranslate"><span class="pre">asyncio</span></code> facility allows it to run in parallel with the ROS node.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main()</span></code> creates an asynchronous task for the mission script.  The mission code flies the drone in a continuous pattern, repeating forever.  Otherwise it is very similar to the other Project AirSim Python client script examples, except that the client and world objects are created externally and passed-in.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main()</span></code> checks once a second for ROS being shutdown (by receiving the Ctrl-C signal is most common).  When <code class="docutils literal notranslate"><span class="pre">rospy.is_shutdown()</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">main()</span></code>  cancels the mission task–that task receives a CancelledError exception and exits.  <code class="docutils literal notranslate"><span class="pre">main()</span></code> then disconnects the <code class="docutils literal notranslate"><span class="pre">AirSimVNetClient</span></code> object from Project AirSim and also exits.  It’s important that <code class="docutils literal notranslate"><span class="pre">main()</span></code> uses <code class="docutils literal notranslate"><span class="pre">await</span></code> in between calls to <code class="docutils literal notranslate"><span class="pre">rospy.is_shutdown()</span></code>–see <strong>Note 3</strong>.</p></li>
<li><p>In the meanwhile, the <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> object has also been notified that ROS is being shutdown.  It stops its ROS node activities and frees its resources.  The call to <code class="docutils literal notranslate"><span class="pre">rospy.spin()</span></code> in the main Python thread then returns and the main Python thread also exits.  When all threads have exited, the app closes.</p></li>
</ul>
<p><strong>Notes:</strong></p>
<ol class="arabic simple">
<li><p>By employing a custom filter, the <code class="docutils literal notranslate"><span class="pre">_redirecting_log_filter()</span></code> function, the standard logger used by Project AirSim is redirected to the <code class="docutils literal notranslate"><span class="pre">rosout.projectairsim</span></code> logger.  It is a child of the <code class="docutils literal notranslate"><span class="pre">rosout</span></code> logger and with the default ROS logging configuration it sends logging output from Project AirSim to the command prompt/terminal in addition to the log file.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> creates the <code class="docutils literal notranslate"><span class="pre">ProjectAirSimClient</span></code> object, it’s available from the <code class="docutils literal notranslate"><span class="pre">projectairsim_client</span></code> attribute.  With it, you can load a scene by creating a <code class="docutils literal notranslate"><span class="pre">World</span></code> object, then calling <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper.update_topics()</span></code> so that it can update the node’s topics to match the scene.  This is slightly less efficient since <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> will have automatically done this once already when it was created.  If <code class="docutils literal notranslate"><span class="pre">ProjectAirSimWrapper</span></code> creates the client, it will disconnect it when ROS is shutdown.  If you pass in a client, it will <em>not</em> disconnect it automatically so you can do so when appropriate.</p></li>
<li><p>The Python <code class="docutils literal notranslate"><span class="pre">asyncio</span></code> facility uses cooperative multitasking.    The calls to <code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">asyncio.sleep()</span></code> allows other asychronous tasks like the mission task to run while <code class="docutils literal notranslate"><span class="pre">main()</span></code> sleeps.  The <code class="docutils literal notranslate"><span class="pre">await</span></code> statements in the mission script (or any other <code class="docutils literal notranslate"><span class="pre">asyncio</span></code> task) won’t proceed while another task (like <code class="docutils literal notranslate"><span class="pre">main()</span></code>) is running without relenquishing control by, for instance, calling <code class="docutils literal notranslate"><span class="pre">await</span></code> statements.  Newly created tasks may not even start.</p></li>
</ol>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<p>Samples of using the Project AirSim ROS Bridge are provided in the <code class="docutils literal notranslate"><span class="pre">ros/examples</span></code> directory.  See <a class="reference internal" href="#ros_examples.md"><span class="xref myst">Project AirSim ROS Bridge Examples</span></a> for more information.</p>
<hr class="docutils" />
<p>Copyright (C) Microsoft Corporation.  All rights reserved.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>