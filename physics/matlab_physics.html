

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matlab Physics for Drones &mdash; Project Airsim 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulation Clock" href="../scene/sim_clock.html" />
    <link rel="prev" title="Fast Physics for Drones" href="fast_physics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Project Airsim
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Sensors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_capture_settings.html">Supported imaging/capture camera customizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_capture_settings.html#sample-config">Sample config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_post_processing_with_nn.html">Camera Images Post processing using Neural Network models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_post_processing_with_nn.html#image-post-processing-settings">Image post processing settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_post_processing_with_nn.html#post-processing-model-settings">Post processing model settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/camera_streaming.html">Camera Streaming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/segmentation.html">Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/lidar.html">Lidar sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/lidar.html#lidar-sensor-settings">Lidar sensor settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/radar.html">Radar sensor overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/radar.html#radar-sensor-settings">Radar sensor settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/battery.html">Battery sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensors/battery.html#battery-sensor-settings">Battery sensor settings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics and Simulation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="fast_physics.html">Fast Physics for Drones</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Matlab Physics for Drones</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-matlab-engine-api-for-python">Install Matlab Engine API for Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-scripts-with-simulink-physics">Example Scripts with Simulink Physics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#directory-information">Directory Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-scripts">Running the Scripts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scene/sim_clock.html">Simulation Clock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scene/weather_visual_effects.html">Weather Visual Effects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Controllers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../controllers/controllers.html">Flight Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/simple_flight.html">Simple Flight Controller for Drones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4.html">PX4 Autopilot Flight Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_build.html">Building PX4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_hitl.html">Using a PX4 Controller as Hardware-In-The-Loop (HITL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_lockstep.html">PX4 Lockstep Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_multi_vehicle.html">PX4 with Multiple Robots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_sitl.html">Using a PX4 Controller as Software-In-The-Loop (SITL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers/px4/px4_sitl_wsl2.html">PX4 Software-in-the-Loop with WSL 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Settings</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://iamaisim.github.io/ProjectAirSim/api_docs/index.html">Python Client API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Project Airsim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Matlab Physics for Drones</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/physics/matlab_physics.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="matlab-physics-for-drones">
<h1>Matlab Physics for Drones<a class="headerlink" href="#matlab-physics-for-drones" title="Link to this heading">¶</a></h1>
<p>Project AirSim allows users to import their existing Simulink physics models as an alternative to the built-in Fast Physics. The AirSim server transmits information about the applied vehicular forces and the environmental state which the Simulink model processes to compute the vehicle’s kinematic state, all through TCP.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h2>
<p>Download and install Matlab + Simulink 2022a with the Aerospace Blockset add-on.</p>
</section>
<section id="install-matlab-engine-api-for-python">
<h2>Install Matlab Engine API for Python<a class="headerlink" href="#install-matlab-engine-api-for-python" title="Link to this heading">¶</a></h2>
<p>In order to connect to Matlab from the Python client, the Matlab Engine API for Python must be installed. More information can be found on the MathWorks <a class="reference external" href="https://www.mathworks.com/help/matlab/matlab_external/install-the-matlab-engine-for-python.html">documentation</a> but the general installation steps are prescribed below:</p>
<ol class="arabic simple">
<li><p>Run a command prompt as Administrator</p></li>
<li><p>Activate a Python virtual environment and navigate to the directory where the Matlab API Python library is installed: <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">&quot;C:\Program</span> <span class="pre">Files\MATLAB\R2022a\extern\engines\python&quot;</span></code></p></li>
<li><p>Install the Matlab API Python library: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code></p></li>
</ol>
</section>
<section id="example-scripts-with-simulink-physics">
<h2>Example Scripts with Simulink Physics<a class="headerlink" href="#example-scripts-with-simulink-physics" title="Link to this heading">¶</a></h2>
<p>The example Python client scripts and configuration files can be found in <code class="docutils literal notranslate"><span class="pre">client/python/example_user_scripts/</span></code> and the corresponding Matlab model files can be found in <code class="docutils literal notranslate"><span class="pre">client/python/example_user_scripts/simulink/</span></code>. There are currently two user scripts - <code class="docutils literal notranslate"><span class="pre">simulink_quadrotor_standardized_model.py</span></code> and <code class="docutils literal notranslate"><span class="pre">simulink_quadtiltrotor_standardized_model.py</span></code> - both of which utilize the same Simulink model but with different parameter values for each airframe. The AirSim Simulink interface currently supports up to eight rotors and eight control surfaces.</p>
<section id="directory-information">
<h3>Directory Information<a class="headerlink" href="#directory-information" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Scripts beginning with <code class="docutils literal notranslate"><span class="pre">simulink_</span></code> in their name utilize Simulink physics. Each script references a scene configuration file.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sim_config/</span></code> folder contains both scene configuration files and robot configuration files. Note the former contains a <code class="docutils literal notranslate"><span class="pre">physics-connection</span></code> parameter to connect to Matlab and references the latter in the <code class="docutils literal notranslate"><span class="pre">robot-config</span></code> parameter. The robot configuration file has its <code class="docutils literal notranslate"><span class="pre">physics-type</span></code> parameter set to <code class="docutils literal notranslate"><span class="pre">matlab-physics</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">simulink/</span></code> folder contains the Matlab model loader m-file scripts, the Simulink models, and the S-function mex file. Each Matlab script loads the vehicle parameters, opens the Simulink model, and configures the Matlab Engine for the client script to use Python APIs to control. The Simulink model contains the drone and fixed-wing physics for the vehicle, and references the vehicle parameters loaded via the Matlab script.</p></li>
</ul>
</section>
<section id="running-the-scripts">
<h3>Running the Scripts<a class="headerlink" href="#running-the-scripts" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Open Matlab 2022a.</p></li>
<li><p>Navigate the Matlab file explorer to the <code class="docutils literal notranslate"><span class="pre">client/python/example_user_scripts/simulink/</span></code> folder.</p></li>
<li><p>Run the model loader m-file from the <strong>Matlab console</strong>:</p>
<ol class="arabic simple">
<li><p>ex. <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span> <span class="pre">load_quadrotor_simulink_physics_model</span></code></p></li>
</ol>
</li>
<li><p>Launch and run the simulation server.</p></li>
<li><p>In an activated Python environment, navigate to <code class="docutils literal notranslate"><span class="pre">client/python/example_user_scripts/</span></code> and run the corresponding client script:</p>
<ol class="arabic simple">
<li><p>ex. <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">simulink_quadrotor_standardized_model.py</span></code></p></li>
</ol>
</li>
<li><p>After the simulation scene has started, it will automatically start the Simulink model through the Matlab Python API.</p></li>
<li><p>Once the script completes, it will automatically stop the Simulink model through the Matlab Python API. To restart the script, just run it again. To stop the simulation while the it is in progress, press Ctrl-C from the Python script console output to stop the in-progress flight command, stop Simulink, and disconnect the client. The simulation can be started again by simply running the script again.</p></li>
</ol>
<hr class="docutils" />
<p>Copyright (C) Microsoft Corporation.  All rights reserved.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fast_physics.html" class="btn btn-neutral float-left" title="Fast Physics for Drones" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../scene/sim_clock.html" class="btn btn-neutral float-right" title="Simulation Clock" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>